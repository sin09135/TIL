## 시계열 데이터 Basic

### 1. 시계열 데이터의 특성

- 시간이라는 독립변수(고정된 축), 기존 데이터의 특성과는 다른 시계열만의 특성

- 자기 상관관계

  - 과거의 데이터가 현재의 데이터에 영향을 주는 경향
  - 예) 우리나라 인구수는 자기 상관 관계가 매우 높다

- 추세 경향성

  - 시계열 데이터의 장기적으로 점차 증가 또는 감소하는 추세

- 계절성(Seasonality), 순환성(Cycle)

  - 중장기적인 추세 경향성 외에 날짜나 기간에 따른 주기적으로 변화하는 것
  - 추세가 반복되는 변동성 등

- 불확실성

  - 미래의 예측값은 현재로서는 정확히 모른다

    

**시계열 예측의 신뢰구간에서 가장 먼저 이해할 것은 시계열 예측의 예측 기간이 길어질수록 예측 신뢰구간 데이터 분포가 점점 넓어지고 먼 미래의 예측은 더 힘들고 어려워진다.**

---

### 시계열 분석

탐색 목적 : 외부 인자와 관련된 계절적 패턴, 추세 설명 인과관계 규명

예측 목적 : 과거 데이터 패턴을 통해 미래 값 예측 시계열 데이터는 Xt = St(신호) + At(잡음)



#### ACF

자기상관함수 시계열 데이터 주기성 수치적 확인

ACF : k 시간 단위로 구분된 시계열 관측치 간의 Yt와 Yt+k 간 상관관계를 측정하는 것이다. ACF의 반환값의 절대값이 커질수록 시차 시계열 데이터의 상관성이 크다고 할 수 있다. 이 크다는 것의 기준은 p-value 와 같이 95% 근사 신뢰구간으로 정할 수 있다. 



#### PACF

편자기상관함수, Y의 시점과 특성 t-k의 시점 이외의 모든 시점과의 영향력을 배제한 순수한 영향력을 나타내는 척도



### ARIMA

AR, MA 모형 분석 시작하기 전 정상성을 만들고 시작한다.

정상성 : 모든 시점에 대해서 일정한 평균을 갖도록 하는 것, 즉 추세나 계절성이 없는 시계열 데이터로 만들어 주는 것

즉, 정상성을 아나태는 시계열은 평균과 분산이 안정되어 있는 상태



지연과 차분



#### AR 자기회귀모델

회귀 기반의 시계열 분석, 시차변수만 사용하는 개념(**과거시점**에 대한 정상시계열을 가지고 미래를 계속 예측)



#### MA 

관측값 이전 시점의 연속적인 예측 **오차**의 영향을 이용하는 방법

해당 시점의 오차항 e에 n시점 이전의 오차항에 이동평균계수를 곱한 값들을 더해준다.



#### ARMA

두 모델 각각 사용하는 시점의 수에 따라 두 모델을 결합, 과거 시점의 수치와 변동성을 모두 활용하여 보다 정교한 예측을 수행함



#### ARIMA

하지만, 보통 시계열 데이터는 추세를 가지고 있으며, 일정한 패턴이 있음

따라서 대부분 불안정한 패턴임.

그래서 모델 자체의 불안정성을 제거하는 기법 ARIMA

시계열의 비정상성을 설명하기 위해 시점간의 차분을 사용하는 것

AR 모델의 자기 휘귀 부분의 차수, MA 모델의 이동평균부분의 차수, 그리고 1차 차분이 포함된 정도를 포함하려 

ARIMA(p,d,q) 표현

---

### 요약

**AR(p) 모델**은 p 만큼 과거의 값들을 예측에 이용하는 것이고,

**MA(q) 모델**은 q 만큼 과거의 오차 값들을 예측에 이용하는 것

따라서, ARMA(p,q) 모델은 p 만큼의 과거의 값들과 q만큼의 과거의 오차 값들을 예측에 이용한다.

ARIMA(p,d,q) 모델은 시계열 데이터를 d회 차분하고(정상시계열로 만들기 위해서)

 p 만큼 과거의 값들과 q만큼의 오차의 값들을 통해 수치를 예측하고 차분한 값을 원래 다시 원래의 값으로 반환하여 최종 예측값을 산출한다.



#### ARIMA(p,d,q)

1. ACF 그래프를 통해 시계열 데이터가 정상 시계열인지 확안히는 것, 시계열 데이터 자체에서 비정상으로 나오게 되면 정상으로 바꿔야 하는 차분 등을 진행
2. 그 다음 ACF, PACF 값을 통해 p와 q의 값을 설정
3. ARIMA(p,d,q) 모델의 파라미터 작성



##### LSTM, tensorflow 에서 제공하는 시계열 예측 패키지 prophet 예측 등 조금씩은 다르지만, 기본적인 시계열 데이터의 특성을 가지고 접근하는 것은 비슷하다.